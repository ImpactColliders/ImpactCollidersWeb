<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Impact Colliders - Video Library</title>
    <link rel="icon" type="image/x-icon" href="/assets/images/logo.jpg" />
    <link
      href="https://fonts.googleapis.com/css?family=Poppins:300,400,600&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      type="text/css"
      href="assets/css/bootstrap.min.css"
    />
    <link rel="stylesheet" type="text/css" href="assets/css/font-awesome.css" />
    <link rel="stylesheet" href="assets/css/templatemo-lava.css" />
    <link rel="stylesheet" href="assets/css/owl-carousel.css" />
    <style>
      body {
        font-family: "Poppins", sans-serif;
        background: #f9f9f9;
        padding-top: 100px;
      }
      .content-container {
        max-width: 900px;
        margin: 0 auto 3rem auto;
        padding: 0 15px;
      }
      section {
        display: none;
        margin-bottom: 3rem;
        position: relative;
        background: white;
        padding: 1rem 1.5rem 2rem 1.5rem;
        border-radius: 8px;
        box-shadow: 0 3px 8px rgba(0, 0, 0, 0.1);
      }
      section.active {
        display: block;
      }
      h2 {
        color: #e43f5a;
        margin-bottom: 1rem;
        font-weight: 600;
      }
      iframe {
        width: 100%;
        height: 450px;
        border: none;
        border-radius: 6px;
        box-shadow: 0 1px 5px rgba(0, 0, 0, 0.15);
      }
      button.copy-btn,
      button.copy-qr-btn {
        position: absolute;
        top: 12px;
        background: #e43f5a;
        color: white;
        border: none;
        padding: 6px 12px;
        font-weight: 600;
        cursor: pointer;
        border-radius: 4px;
        transition: background 0.3s ease;
        font-size: 0.9rem;
        z-index: 10;
      }
      button.copy-btn:hover,
      button.copy-qr-btn:hover {
        background: #b92c41;
      }
      button.copy-btn {
        right: 12px;
      }
      button.copy-qr-btn {
        right: 130px;
      }
      p.message {
        font-style: italic;
        color: gray;
        margin-top: 1rem;
        text-align: center;
        font-size: 1rem;
      }
      @media (max-width: 576px) {
        button.copy-btn,
        button.copy-qr-btn {
          top: 8px;
          padding: 5px 10px;
          font-size: 0.8rem;
        }
        button.copy-btn {
          right: 8px;
        }
        button.copy-qr-btn {
          right: 100px;
        }
        iframe {
          height: 250px;
        }
      }

      .video-wrapper {
        position: relative;
        width: 100%;
        height: 100%;
        display: flex;
        justify-content: center;
      }

      .video-wrapper iframe {
        width: 100%;
        max-width: none;
        aspect-ratio: 9 / 16;
        height: 85%;
        border: none;
        border-radius: 10px;
        background: #000;
        display: none;
        box-shadow: 0 1px 5px rgba(0, 0, 0, 0.2);
      }

      .video-wrapper iframe.video-start {
        display: block;
      }

      @media (max-width: 768px) {
        .video-wrapper {
          position: relative;
          height: 80%;
          display: flex;
          justify-content: center;
        }

        .video-wrapper iframe {
          width: 100%;
          max-width: none;
          height: 100%;
          aspect-ratio: auto;
          border-radius: 0;
          box-shadow: none;
        }
      }

      .video-description {
        font-size: 0.95rem;
        color: #444;
        margin-top: 0.5rem;
        margin-bottom: 1.2rem;
      }
      .nav-arrow {
        position: absolute;
        top: 50%;
        transform: translateY(-50%);
        font-size: 2rem;
        background: rgba(228, 63, 90, 0.8);
        border: none;
        color: white;
        padding: 6px 12px;
        border-radius: 4px;
        cursor: pointer;
        z-index: 15;
        transition: background 0.3s ease;
      }
      .nav-arrow:hover {
        background: rgba(185, 44, 65, 0.8);
      }
      .left-arrow {
        left: -50px;
      }
      .right-arrow {
        right: -50px;
      }
      @media (max-width: 768px) {
        .nav-arrow {
          display: none;
        }
      }

      .content-container section {
        height: 85dvh;
      }

      .video-section {
        height: 100%;
        width: 100%;
      }

      .touch-overlay {
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        z-index: 10;
        background: transparent;
        touch-action: none; /* ensures touch events are captured */
      }
    </style>
  </head>
  <body>
    <!-- Nav Bar -->
    <header class="header-area header-sticky" id="nav-placeholder">
      <div class="container">
        <div class="row">
          <div class="col-12">
            <nav class="main-nav">
              <a href="index.html" class="logo">
                <img
                  src="assets/images/Impact Colliders_Black.png"
                  alt="Impact Colliders Logo"
                />
              </a>
              <ul class="nav">
                <li><a href="index.html">Home</a></li>
                <li><a href="about.html">About Us</a></li>
                <li><a href="appnav.html" class="active">Video Library</a></li>
                <li><a href="videos.html?show=all">Digital Game</a></li>
                <li><a href="shop.html">Shop</a></li>
              </ul>
              <a class="menu-trigger"><span>Menu</span></a>
            </nav>
          </div>
        </div>
      </div>
    </header>

    <main class="content-container" id="video-container">
      <p id="message" class="message"></p>
    </main>

    <script src="assets/js/jquery-2.1.0.min.js"></script>
    <script src="assets/js/popper.js"></script>
    <script src="assets/js/bootstrap.min.js"></script>
    <script src="assets/js/owl-carousel.js"></script>
    <script src="assets/js/scrollreveal.min.js"></script>
    <script src="assets/js/waypoints.min.js"></script>
    <script src="assets/js/jquery.counterup.min.js"></script>
    <script src="assets/js/imgfix.min.js"></script>
    <script src="assets/js/custom.js"></script>
    <script>
      const videoContainer = document.getElementById("video-container");

      // Define your video data here
      const videos = [
        {
          title: "Tutorial",
          url1: "Videos/TheStraitsTimes.mp4",
          description1: "Step 1",
          url2: "Videos/TheStraitsTimes.mp4",
          description2: "Step 2",
          url3: "Videos/TheStraitsTimes.mp4",
          description3: "Step 3",
          url4: "Videos/TheStraitsTimes.mp4",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Login",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Web Navigation",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Notes/Memos",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Weather",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Alarms",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Singpass",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "MyTransport",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Grab",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Google Maps",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Zoom",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Whatsapp",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Contacts",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "HealthHub",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Pillbox",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Facebook",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "The Straits Times",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Youtube",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        {
          title: "Paynow",
          url1: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description1: "Step 1",
          url2: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description2: "Step 2",
          url3: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description3: "Step 3",
          url4: "https://www.youtube.com/embed/CyEBYKXDkcA?autoplay=1",
          description4: "Step 4",
          time1: 5,
          time2: 10,
          time3: 15,
          time4: 20,
        },
        // Add more videos here
      ];

      videos.forEach((video, index) => {
        const section = document.createElement("section");
        section.dataset.index = index + 1;
        section.id = `Section${index + 1}`;

        section.innerHTML = `
        <h2>${video.title}</h2>
        <div class="video-wrapper" data-index="${
          index + 1
        }" style="position: relative; display: flex; justify-content: center; align-items: center; flex-direction: column;">
          <!-- Left Arrow -->
          <button class="nav-arrow left-arrow" onclick="goToSiblingSection(-1)">&#8592;</button>
          <!-- Right Arrow -->
          <button class="nav-arrow right-arrow" onclick="goToSiblingSection(1)">&#8594;</button>

          <!-- Video Section -->
          <div class="video-section" style="display: flex; justify-content: center; align-items: center; flex-direction: column;">
            <video style="width: 80%; height: 80%;" class="video-start" controls preload="metadata">
              <source src="${video.url1}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <div class="touch-overlay"></div>
            <p class="video-description">${video.description1}</p>
          </div>

          <div class="video-section" style="display:none; justify-content: center; align-items: center; flex-direction: column;">
            <video style="width: 80%; height: 80%;" class="video-start" controls preload="metadata">
              <source src="${video.url2}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <div class="touch-overlay"></div>
            <p class="video-description">${video.description2}</p>
          </div>

          <div class="video-section" style="display:none; justify-content: center; align-items: center; flex-direction: column;">
            <video style="width: 80%; height: 80%;" class="video-start" controls preload="metadata">
              <source src="${video.url3}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <div class="touch-overlay"></div>
            <p class="video-description">${video.description3}</p>
          </div>

          <div class="video-section" style="display:none; justify-content: center; align-items: center; flex-direction: column;">
            <video style="width: 80%; height: 80%;" class="video-start" controls preload="metadata">
              <source src="${video.url4}" type="video/mp4">
              Your browser does not support the video tag.
            </video>
            <div class="touch-overlay"></div>
            <p class="video-description">${video.description4}</p>
          </div>
        </div>

        <button class="copy-qr-btn" data-section="${
          index + 1
        }">Copy QR Code</button>
        <button class="copy-btn" data-section="${index + 1}">Copy URL</button>
      `;

        videoContainer.appendChild(section);
      });
      //SPACER

      // After your sections are created
      document.querySelectorAll(".video-wrapper").forEach((wrapper) => {
        const sections = wrapper.querySelectorAll(".video-section");
        sections.forEach((sec, index) => {
          const video = sec.querySelector("video");
          if (!video) return;

          video.addEventListener("timeupdate", () => {
            const wrapperIndex = wrapper.dataset.index - 1;
            const videoData = videos[wrapperIndex];
            var switching = false;

            // Determine next step time
            let nextTime = null;
            switch (index) {
              case 0:
                nextTime = videoData.time2;
                break;
              case 1:
                nextTime = videoData.time3;
                break;
              case 2:
                nextTime = videoData.time4;
                break;
              default:
                nextTime = null;
            }

            if (
              nextTime !== null &&
              video.currentTime >= nextTime &&
              !switching
            ) {
              // Move to next section
              goToSiblingSection(1);
              switching = true;
            }
          });
        });
      });

      // Modified goToSiblingSection to take a wrapper parameter
      function goToSiblingSectionWithVideo(wrapper, direction) {
        const sections = wrapper.querySelectorAll(".video-section");
        let currentIndex = -1;

        sections.forEach((sec, i) => {
          if (sec.style.display !== "none") currentIndex = i - 1;
        });
        if (currentIndex === -1) return;

        let nextIndex = currentIndex + direction;

        // Clamp nextIndex between 0 and sections.length - 1
        if (nextIndex < 0) nextIndex = 0;
        if (nextIndex >= sections.length) nextIndex = sections.length - 1;

        sections.forEach((sec, i) => {
          const video = sec.querySelector("video");
          if (!video) return;

          if (i === nextIndex) {
            sec.style.display = "flex";

            // Set the video time according to the step
            const wrapperIndex = wrapper.dataset.index - 1;
            const videoData = videos[wrapperIndex];
            let startTime = 0;
            switch (nextIndex) {
              case 0:
                startTime = videoData.time1 || 0;
                break;
              case 1:
                startTime = videoData.time2 || 0;
                break;
              case 2:
                startTime = videoData.time3 || 0;
                break;
              case 3:
                startTime = videoData.time4 || 0;
                break;
            }

            // Only advance if the current time is behind startTime
            if (video.currentTime < startTime) video.currentTime = startTime;
            video.play().catch(() => {});
          } else {
            sec.style.display = "none";
            video.pause();
          }
        });
      }

      const params = new URLSearchParams(window.location.search);
      const show = params.get("show");
      const messageEl = document.getElementById("message");
      const sections = document.querySelectorAll("section");

      if (show) {
        if (show === "all") {
          sections.forEach((sec) => sec.classList.add("active"));
          messageEl.textContent = "Showing all sections.";
        } else {
          const section = document.querySelector(
            `section[data-index="${show}"]`
          );
          if (section) {
            section.classList.add("active");
            messageEl.textContent = `Showing section ${show}.`;
          } else {
            messageEl.textContent = `Section ${show} not found.`;
            messageEl.style.color = "red";
          }
        }
      } else {
        messageEl.textContent =
          "Please specify a section via ?show=1 (or 2, 3) or ?show=all";
      }

      // Copy URL buttons
      document.querySelectorAll("button.copy-btn").forEach((btn) => {
        btn.addEventListener("click", () => {
          const sectionId = btn.getAttribute("data-section");
          const url = `https://www.impactcolliders.com/videos.html?show=${sectionId}`;
          navigator.clipboard
            .writeText(url)
            .then(() => {
              btn.textContent = "Copied!";
              setTimeout(() => (btn.textContent = "Copy URL"), 1500);
            })
            .catch(() => alert("Failed to copy URL"));
        });
      });

      // Copy QR Code buttons
      document.querySelectorAll("button.copy-qr-btn").forEach((btn) => {
        btn.addEventListener("click", async () => {
          const sectionId = btn.getAttribute("data-section");
          const url = `https://www.impactcolliders.com/videos.html?show=${sectionId}`;
          try {
            const container = document.createElement("div");
            container.style.position = "fixed";
            container.style.left = "-9999px";
            document.body.appendChild(container);

            const qr = new QRCode(container, {
              text: url,
              width: 256,
              height: 256,
              correctLevel: QRCode.CorrectLevel.H,
            });

            await new Promise((resolve) => setTimeout(resolve, 100));
            let img = container.querySelector("img");
            let canvas;
            if (img) {
              canvas = document.createElement("canvas");
              canvas.width = img.naturalWidth;
              canvas.height = img.naturalHeight;
              const ctx = canvas.getContext("2d");
              ctx.drawImage(img, 0, 0);
            } else {
              canvas = container.querySelector("canvas");
            }

            if (!canvas)
              throw new Error("Could not find QR code image or canvas.");

            canvas.toBlob(async (blob) => {
              if (!blob) {
                alert("Failed to convert QR code to image.");
                container.remove();
                return;
              }
              try {
                await navigator.clipboard.write([
                  new ClipboardItem({ "image/png": blob }),
                ]);
                btn.textContent = "QR Copied!";
                setTimeout(() => (btn.textContent = "Copy QR Code"), 1500);
              } catch {
                alert(
                  "Failed to copy QR code image. Your browser may not support this."
                );
              }
              container.remove();
            });
          } catch (err) {
            alert("Error generating or copying QR code: " + err.message);
          }
        });
      });

      function switchVideoSection(button, direction) {
        const wrapper = button.closest(".video-wrapper");
        if (!wrapper) return;

        const sections = wrapper.querySelectorAll(".video-section");
        let currentIndex = -1;

        // Find currently visible section
        sections.forEach((sec, i) => {
          if (sec.style.display !== "none") {
            currentIndex = i;
          }
        });

        if (currentIndex === -1) return;

        const nextIndex =
          (currentIndex + direction + sections.length) % sections.length;

        sections.forEach((sec, i) => {
          const iframe = sec.querySelector("iframe");
          if (!iframe) return;

          let src = iframe.getAttribute("src");
          src = src.replace(/&?mute=\d/, ""); // Remove existing mute param

          if (i === nextIndex) {
            sec.style.display = "block";
            // Unmute the active one
            iframe.setAttribute("src", updateUrlParam(src, "mute", "0"));
          } else {
            sec.style.display = "none";
            // Mute the hidden ones
            iframe.setAttribute("src", updateUrlParam(src, "mute", "1"));
          }
        });
      }

      function resetIframeVideo(iframe) {
        const src = iframe.getAttribute("src");
        iframe.setAttribute("src", src); // Reloads iframe and resets video state
      }

      function resetIframeVideo(iframe) {
        const src = iframe.getAttribute("src");
        iframe.setAttribute("src", src);
      }

      function updateUrlParam(url, param, value) {
        const baseUrl = url.split("?")[0];
        const query = new URLSearchParams(url.split("?")[1] || "");
        query.set(param, value);
        return `${baseUrl}?${query.toString()}`;
      }

      document.querySelectorAll(".video-wrapper").forEach((wrapper) => {
        let startX = null;

        wrapper.addEventListener("touchstart", (e) => {
          startX = e.touches[0].clientX;
        });

        wrapper.addEventListener("touchend", (e) => {
          if (startX === null) return;
          const endX = e.changedTouches[0].clientX;
          const deltaX = endX - startX;

          const swipeThreshold = 50; // minimum px to consider a swipe

          if (Math.abs(deltaX) > swipeThreshold) {
            // Find the arrow button to simulate click
            if (deltaX > 0) {
              // Swipe right → go to previous video (left arrow)
              const leftArrow = wrapper.querySelector(".left-arrow");
              if (leftArrow) leftArrow.click();
            } else {
              // Swipe left → go to next video (right arrow)
              const rightArrow = wrapper.querySelector(".right-arrow");
              if (rightArrow) rightArrow.click();
            }
          }
          startX = null;
        });
      });

      document.querySelectorAll(".video-wrapper").forEach((wrapper) => {
        let startY = null;

        wrapper.addEventListener("touchstart", (e) => {
          startY = e.touches[0].clientY;
        });

        wrapper.addEventListener("touchend", (e) => {
          if (startY === null) return;
          const endY = e.changedTouches[0].clientY;
          const deltaY = endY - startY;

          const swipeThreshold = 50; // px threshold for swipe

          if (Math.abs(deltaY) > swipeThreshold) {
            if (deltaY < 0) {
              // Swipe UP detected
              console.log("Swipe up!");
              // do something on swipe up, e.g., switch to next section
              const rightArrow = wrapper.querySelector(".right-arrow");
              if (rightArrow) rightArrow.click();
            } else {
              // Swipe DOWN detected
              console.log("Swipe down!");
              // do something on swipe down, e.g., switch to previous section

              const leftArrow = wrapper.querySelector(".left-arrow");
              if (leftArrow) leftArrow.click();
            }
          }

          startY = null;
        });
      });

      document.querySelectorAll(".touch-overlay").forEach((overlay) => {
        let startY = null;

        overlay.addEventListener("touchstart", (e) => {
          startY = e.touches[0].clientY;
        });

        overlay.addEventListener("touchend", (e) => {
          if (startY === null) return;
          const endY = e.changedTouches[0].clientY;
          const deltaY = endY - startY;

          const threshold = 50; // px

          if (Math.abs(deltaY) > threshold) {
            if (deltaY < 0) {
              console.log("Swipe up detected");
              // e.g., switchVideoSection or goToSiblingSection(1) or your logic
              goToSiblingSection(1);
            } else {
              console.log("Swipe down detected");
              // e.g., switchVideoSection or goToSiblingSection(-1)
              goToSiblingSection(-1);
            }
          }
          startY = null;
        });
      });

      function goToSiblingSection(direction) {
        console.log("test");
        // Find the overlay that triggered this
        const overlay = event.currentTarget;
        if (!overlay) return;

        const wrapper = overlay.closest(".video-wrapper");
        if (!wrapper) return;

        const sections = wrapper.querySelectorAll(".video-section");
        let currentIndex = -1;

        // Find currently visible section
        sections.forEach((sec, i) => {
          if (sec.style.display !== "none") {
            currentIndex = i;
          }
        });

        if (currentIndex === -1) return;

        const nextIndex =
          (currentIndex + direction + sections.length) % sections.length;

        sections.forEach((sec, i) => {
          const video = sec.querySelector("video");
          if (!video) return;

          if (i === nextIndex) {
            sec.style.display = "flex"; // show
            // Set video time according to the step
            const wrapperIndex = wrapper.dataset.index - 1;
            const videoData = videos[wrapperIndex]; // your videos array
            let startTime = 0;

            // Determine which time to use based on nextIndex
            switch (nextIndex) {
              case 0:
                startTime = videoData.time1 || 0;
                break;
              case 1:
                startTime = videoData.time2 || 0;
                break;
              case 2:
                startTime = videoData.time3 || 0;
                break;
              case 3:
                startTime = videoData.time4 || 0;
                break;
            }

            video.currentTime = startTime;
            video.play().catch(() => {}); // play active video
          } else {
            sec.style.display = "none"; // hide
            video.pause(); // pause hidden videos
          }
        });
      }
    </script>
  </body>
</html>
